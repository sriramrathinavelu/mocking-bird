<!doctype html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Framework to help prepare for interviews with mock tests">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Advanced Test</title>

    <!-- Add to homescreen -->
    <link rel="manifest" href="manifest.json">

    <!-- Fallback to homescreen for Chrome <39 on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Web Starter Kit">
    <link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Web Starter Kit">
    <link rel="apple-touch-icon" href="images/touch/apple-touch-icon.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <meta name="theme-color" content="#3372DF">

    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
    <link rel="canonical" href="http://www.example.com/">
    -->

    <!-- Page styles -->
    <link rel="stylesheet" href="/static/mocktest/styles/main.css">
    <link rel="stylesheet" href="/static/mocktest/styles/components.css">
    
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="/static/mocktest/styles/autocomplete.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

    <!-- bower components (datetime) -->
    <link rel="stylesheet" href="/static/bower_components/curioussolutions-datetimepicker/dist/DateTimePicker.css">
    <script src="/static/bower_components/curioussolutions-datetimepicker/dist/DateTimePicker.js"></script>
    <script src="/static/bower_components/moment/min/moment.min.js"></script>

    <script>
      function getURLParameter(name) {
        return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,''])[1].replace(/\+/g, '%20'))||null;
      }
      
      $(function(){        
        
        $( "#slider" ).slider({
          value:3,
          min: 1,
          max: 5,
          step: 1,
          slide: function(event, ui){
            console.log(ui.value);
            document.getElementById("testquestions").innerHTML = ui.value;
          }
        });

        
      });
    </script>

  </head>
  <body>
    <div class="mediachecker"></div>
    <header class="app-bar promote-layer">
      <div class="app-bar-container">
        <button class="menu"><img src="/static/mocktest/images/hamburger.png" alt="Menu"></button>
        <h1 class="logo"><strong>Crack It!</strong></h1>
        <section class="app-bar-actions"> 
        <!-- Put App Bar Buttons Here -->
        <!-- e.g <button><i class="icon icon-star"></i></button> -->
        {% if isAuthenticated %}
          <button id="logout-button-top"><i class="icon icon-star">Logout</i></button>
          <button id="login-button-top" style="display:none;"><i class="icon icon-star">Login</i></button>
        {% else %}
          <button id="logout-button-top" style="display:none;"><i class="icon icon-star">Logout</i></button>
          <button id="login-button-top"><i class="icon icon-star">Login</i></button>          
        {% endif %}
        </section>
      </div>
    </header>

    <nav class="navdrawer-container promote-layer">
      <h4>Navigation</h4>
      <ul>        
        <li><a href="/">Home</a></li>
        <li><a href="/history.html">History</a></li>
        <li><a href="/savedTests.html">Saved Tests</a></li>        
        <li><a href="#hello">About Us</a></li>
        <li><a href="#getstarted">Contact Us</a></li>        
      </ul>
    </nav>


    <main>
      <div class="centered-small-div">

      <div class="centered-div">
        <div class="centered-input form-label">
          1) When do you like to start the test?
        </div>    
        <img class="centered-icon" src="/static/mocktest/images/icons/clock.png" data-field="datetime" id="teststarttimeparent"/>
        <div id="teststarttime" class="centered-input form-error"></div>
        <div id="dtBoxStart"></div>

        <script type="text/javascript">
          $(function(){

            function isFormValid(){
              console.log("Validating");
              if (!($("#teststarttime").hasClass("form-error") ||
                $("#testendtime").hasClass("form-error"))) {
                $("#advancedtest-button").removeClass("disabled");
              } else {
                if (!$("advancedtest-button").hasClass("disabled")) {
                  $("#advancedtest-button").addClass("disabled");          
                }
              }
            };
            isFormValid();
            var now = new Date();
            var day = now.getDate().toString();
            day = day.length > 1 ? day : '0' + day;
            var month = (now.getMonth() + 1).toString();
            month = month.length > 1 ? month : '0' + month;
            var startEpoch = null;
            var endEpoch = null;

            var nowStr = month + "-" +
                         day + "-" +
                         now.getFullYear() + " " +
                         now.getHours() + ":" +
                         now.getMinutes();


            popup = true;
            if ($(".mediachecker").css("float") == "left" ){
              // Small Screen
              popup = true;
            }   

            console.log(nowStr);

            $("#dtBoxStart").DateTimePicker({
              isPopup: popup,
              minDateTime: nowStr,
              clearButtonContent: "Close",
              dateTimeFormat: "MM-dd-yyyy HH:mm:ss",
              buttonClicked: function(buttonType, inputElement) {
                var dtPickerObj = this;
                if (buttonType == 'SET') {                    
                  dtPickerObj.setDateTimeStringInInputField(
                    $(inputElement)
                  );
                  var valval = $(inputElement).val(); 
                  console.log("Time:" + valval);
                  var startMoment = null;
                  var endMoment = null;
                  if ($(inputElement).attr("id") == "testendtimeparent") {                    
                    endMoment = moment(valval, "MM-DD-yyyy HH:mm:ss");
                    endEpoch = endMoment.utc().unix();  
                    endMoment.local();
                    if (document.getElementById("teststarttime").innerHTML != "") {
                      startMoment = moment(document.getElementById("teststarttime").innerHTML,
                                           "ddd, MMM Do, YYYY HH:mm");
                      if (endMoment < startMoment) {
                        document.getElementById("testendtime").innerHTML = 
                          "Are you planning to completing your test before it starts?";
                        $("#testendtime").addClass("form-error");
                      } else {
                        $("#testendtime").removeClass("form-error");
                        document.getElementById("testendtime").innerHTML = endMoment.format(
                          "ddd, MMM Do, YYYY HH:mm"
                        );
                      }
                    } else {
                      $("#testendtime").removeClass("form-error");
                      document.getElementById("testendtime").innerHTML = endMoment.format(
                        "ddd, MMM Do, YYYY HH:mm"
                      );
                    }
                  } else {
                    startMoment = moment(valval, "MM-DD-yyyy HH:mm:ss");
                    startEpoch = startMoment.utc().unix();
                    startMoment.local();                    
                    if (document.getElementById("testendtime").innerHTML != "") {
                      endMoment = moment(document.getElementById("testendtime").innerHTML,"ddd, MMM Do, YYYY HH:mm");
                      if (endMoment.isValid()) {
                        if (endMoment < startMoment) {
                          document.getElementById("teststarttime").innerHTML = 
                            "Are you planning to start your test after it ends?";
                          $("#teststarttime").addClass("form-error");
                        } else {
                          $("#teststarttime").removeClass("form-error");
                          document.getElementById("teststarttime").innerHTML = startMoment.format(
                            "ddd, MMM Do, YYYY HH:mm"
                          );
                        }
                      }
                    } else {
                      $("#teststarttime").removeClass("form-error");
                      document.getElementById("teststarttime").innerHTML = startMoment.format(
                        "ddd, MMM Do, YYYY HH:mm"
                      );
                    }
                  }
                }
                isFormValid();
              },
              afterShow: function(ipElem) {      
                var dtPickerObj = this; 
                if ($(ipElem).attr("id") == "teststarttimeparent") {
                  if (document.getElementById("teststarttime").innerHTML != "") {
                    var startMoment = moment(document.getElementById("teststarttime").innerHTML,
                                           "ddd, MMM Do, YYYY HH:mm");
                    if (startMoment.isValid()) {
                      dtPickerObj.dataObject.dCurrentDate = startMoment.toDate();
                      dtPickerObj.dataObject.iCurrentDay = startMoment.date();
                      dtPickerObj.dataObject.iCurrentMonth = startMoment.month();
                      dtPickerObj.dataObject.iCurrentYear = startMoment.year();
                      dtPickerObj.dataObject.iCurrentHour = startMoment.hour();
                      dtPickerObj.dataObject.iCurrentMinutes = startMoment.minute();
                    }
                  }
                } else {
                  if (document.getElementById("teststarttime").innerHTML != "") {
                    var startMoment = moment(document.getElementById("teststarttime").innerHTML,
                                           "ddd, MMM Do, YYYY HH:mm");
                    if (startMoment.isValid()) {
                      dtPickerObj.dataObject.dCurrentDate = startMoment.toDate();
                      dtPickerObj.dataObject.iCurrentDay = startMoment.date();
                      dtPickerObj.dataObject.iCurrentMonth = startMoment.month();
                      dtPickerObj.dataObject.iCurrentYear = startMoment.year();
                      dtPickerObj.dataObject.iCurrentHour = startMoment.hour();
                      dtPickerObj.dataObject.iCurrentMinutes = startMoment.minute();
                    }
                  }
                  if (document.getElementById("testendtime").innerHTML != "") {                    
                    var endMoment = moment(document.getElementById("testendtime").innerHTML,
                                           "ddd, MMM Do, YYYY HH:mm");
                    if (endMoment.isValid()) {
                      console.log("enna aachu");
                      dtPickerObj.dataObject.dCurrentDate = endMoment.toDate(); 
                      dtPickerObj.dataObject.dCurrentDate = endMoment.toDate();
                      dtPickerObj.dataObject.iCurrentDay = endMoment.date();
                      dtPickerObj.dataObject.iCurrentMonth = endMoment.month();
                      dtPickerObj.dataObject.iCurrentYear = endMoment.year();
                      dtPickerObj.dataObject.iCurrentHour = endMoment.hour();
                      dtPickerObj.dataObject.iCurrentMinutes = endMoment.minute();
                    }
                  }
                }
                dtPickerObj._setCurrentDate();          
              }
            });


            $("#advancedtest-button").click (function(e){
              if ($("#advancedtest-button").hasClass("disabled")) {
                console.log("Suppressed");
                e.preventDefault();
              } else {
                window.location="createtest.html?companyName=" +
                getURLParameter("companyName") + "&positionName=" + getURLParameter("positionName") + "&numQ=" + $("#testquestions").html() + "&startTime=" + startEpoch + "&endTime=" + endEpoch;
              }
            });
          });
        </script>

        <div class="centered-input form-label">
          2) When do you like to end the test?
        </div>
        <img class="centered-icon" src="/static/mocktest/images/icons/clock.png" data-field="datetime" id="testendtimeparent"/>
        <div id="testendtime" class="centered-input form-error"></div>          
        <div id="dtBoxEnd"></div>

        <div class="centered-input form-label">
          3) How many questions you want to take on?
        </div>
        <div id="slider" class="centered-input"></div>
        <div id="testquestions" class="centered-input">3</div>
      </div>
      <div class="centered-div">
        <a id="advancedtest-button" href="#" class="button--mockingone centered-button">
          Create Test
        </a>
      </div>
    </main> 



    <script src="/static/mocktest/scripts/main.js"></script>

    <!-- Google Analytics: change UA-XXXXX-X to be your site's ID -->
	<!--
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-XXXXX-X', 'auto');
      ga('send', 'pageview');
    </script>
	-->
    <!-- Built with love using Web Starter Kit -->
  </body>
</html>
